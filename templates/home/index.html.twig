{% extends 'base.html.twig' %}

{% block title %}Trick{% endblock %}

{% block stylesheets %}
        <link href="{{ asset('css/app.css') }}" rel="stylesheet">
{% endblock %}


{% block content %}
    <div class="bg_img d-flex flex-column justify-content-center">
        <div class="d-flex flex-column text-center">
            <h1>SNOWTRICKS</h1>
            <p class="lead m-3">Site collaboratif pour faire connaître le SnowBoard auprès du grand public et aider à l'apprentissage des figures</p>
        </div>
        <div class="d-flex flex-column text-end d-none d-lg-block d-md-block d-sm-none">
            <a href="#trick-section"><img class="arrow-down" src="{{ asset('images/fleche.svg') }}"></a>
        </div>
    </div>

    <div id="trick-section" class="text-center">
        <h2 class="text-dark m-1">Tous les tricks</h2>
        <p class="font-weight-bold m-1">Toutes les figures entrées par les utilisateurs</p>
            {% for trick in tricks %}   
                <div class="{{ loop.index > 10 ? 'd-none' : null}}">
                    <div class="d-flex flex-row justify-content-around m-1">
                        {% for picture in trick.picture %}
                            <div class="d-flex flex-column">
                                <div>
                                    <img src="/images/picture_upload/{{ picture.path }}" width="250px" height="150px" class="">
                                </div>
                                <div class="d-flex flex-row justify-content-around">
                                        <a href="{{ path('trick_show', {'id': trick.id}) }}" class="mt-2">{{ trick.name }}</a>
                                    {% if app.user %}
                                        <a href="{{ path('trick_edit', {'id': trick.id}) }}"><img class="mt-2" src="{{ asset('images/edit.svg') }}"></a>
                                        {{ include('trick/_delete_form.html.twig') }}
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                        {% for video in trick.video %}
                            <div class="d-flex flex-column ratio-1x1">
                                <iframe src="https://youtube.com/embed/{{ video.url }}" title="YouTube video" class=""></iframe>
                                    <div class="d-flex flex-row justify-content-around">
                                        <a href="{{ path('trick_show', {'id': trick.id}) }}">{{ trick.name }}</a>
                                            {% if app.user %}
                                                <a href="{{ path('trick_edit', {'id': trick.id}) }}"><img class="mt-2" src="{{ asset('images/edit.svg') }}"></a>
                                                {{ include('trick/_delete_form.html.twig') }}
                                            {% endif %}
                                    </div>
                            </div>
                        {% endfor %}
                    </div>  
                </div>
            {% endfor %}
        </div>
        <div class="text-center">
            <button class="buttonload">
                <i class="fa fa-spinner fa-spin"></i>Voir plus
            </button> 
        </div>

        //probleme
        {% for picture in trick.picture %}
            {% if picture > (2) %}
            <div class="text-end m-4">
                <button id="haut" onclick="retourHaut()" title="Retour haut de page">
                    <img class="arrow-up" src="{{ asset('images/arrow-up.svg') }}">
                </button>
            </div>
            {% endif %}
        {% endfor %}
{% endblock %}

{% block javascripts %}  
    <script type="text/javascript">
    $(function () { 
        $('.buttonload').on('click', function (e) { 
            e.preventDefault(); 
            let $cards = $('.d-none').slice(0, 10);
            if ($cards.length === 0) { 
                $('.buttonload').remove(); 
            } 
            $cards.each(function (x) { 
                $(this).removeClass('d-none') 
            }) 
        })
    })

    function retourHaut()
        {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }
    </script>
{% endblock %}